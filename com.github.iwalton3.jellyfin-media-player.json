{
  "app-id": "com.github.iwalton3.jellyfin-media-player",
  "runtime": "org.kde.Platform",
  "runtime-version": "5.15-22.08",
  "sdk": "org.kde.Sdk",
  "base": "io.qt.qtwebengine.BaseApp",
  "base-version": "5.15-22.08",
  "command": "jellyfinmediaplayer",
  "finish-args": [
    "--socket=fallback-x11",
    "--socket=wayland",
    "--socket=pulseaudio",
    "--share=ipc",
    "--share=network",
    "--device=all",
    "--talk-name=org.freedesktop.PowerManagement",
    "--talk-name=org.freedesktop.ScreenSaver",
    "--own-name=org.mpris.MediaPlayer2.mpv",
    "--system-talk-name=org.freedesktop.login1"
  ],
  "modules": [
    {
      "name": "jellyfin-media-player",
      "buildsystem": "cmake-ninja",
      "config-opts": [
        "-DCMAKE_BUILD_TYPE=Release",
        "-DQTROOT=/usr",
        "-DOpenGL_GL_PREFERENCE=GLVND"
      ],
      "post-install": [
        "install -Dm644 resources/meta/com.github.iwalton3.jellyfin-media-player.desktop /app/share/applications/com.github.iwalton3.jellyfin-media-player.desktop",
        "install -Dm644 resources/images/icon.png /app/share/icons/hicolor/256x256/apps/com.github.iwalton3.jellyfin-media-player.png",
        "install -Dm644 resources/images/icon.svg /app/share/icons/hicolor/scalable/apps/com.github.iwalton3.jellyfin-media-player.svg",
        "install -Dm644 resources/meta/com.github.iwalton3.jellyfin-media-player.appdata.xml /app/share/metainfo/com.github.iwalton3.jellyfin-media-player.appdata.xml"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/iwalton3/jellyfin-media-player.git",
          "tag": "v1.9.1",
          "commit": "086fd6a5217ffcb907fa6c34f9fbbc6f59bb4e60",
          "x-checker-data": {
            "type": "git",
            "tag-pattern": "^v([\\d.]+)$"
          }
        },
        {
          "type": "archive",
          "url": "https://repo.jellyfin.org/releases/server/portable/versions/stable/web/10.8.13/jellyfin-web_10.8.13_portable.tar.gz",
          "sha256": "cbd00c3c3a56d7d17d63dc6060b5cbc011820a83cde64b7f9c93690fbac174d6",
          "dest": "dist",
          "x-checker-data": {
            "type": "html",
            "url": "https://repo.jellyfin.org/releases/server/portable/versions/stable/web/",
            "version-pattern": "(\\d+\\.\\d+\\.\\d+)\\/",
            "url-template": "https://repo.jellyfin.org/releases/server/portable/versions/stable/web/$version/jellyfin-web_${version}_portable.tar.gz"
          }
        }
      ],
      "modules": [
        {
          "name": "mpv",
          "buildsystem": "meson",
          "config-opts": [
            "-Dlibmpv=true",
            "-Dcplayer=false",
            "-Dbuild-date=false",
            "-Dmanpage-build=disabled",
            "-Dvaapi=enabled",
            "-Dcuda-hwaccel=enabled",
            "-Dpulse=enabled",
            "-Dalsa=enabled",
            "-Duchardet=enabled"
          ],
          "cleanup": [
            "/lib/pkgconfig",
            "/share",
            "/include"
          ],
          "sources": [
            {
              "type": "git",
              "url": "https://github.com/mpv-player/mpv.git",
              "tag": "v0.37.0",
              "commit": "818ce7c51a6b9179307950e919983e0909942098",
              "x-checker-data": {
                "type": "git",
                "tag-pattern": "^v([\\d.]+)$"
              }
            },
            {
              "type": "file",
              "url": "https://waf.io/waf-2.0.27",
              "sha256": "fe10e266c05063752d098787a7b934cd0d61092c8b072884f8a679c1c596dd6a",
              "dest-filename": "waf",
              "x-checker-data": {
                "type": "anitya",
                "project-id": 5116,
                "url-template": "https://waf.io/waf-$version"
              }
            }
          ],
          "modules": [
            {
              "name": "ffnvcodec",
              "buildsystem": "simple",
              "build-commands": [
                "make install PREFIX=/app"
              ],
              "cleanup": [
                "/lib/pkgconfig",
                "/include"
              ],
              "sources": [
                {
                  "type": "git",
                  "url": "https://github.com/FFmpeg/nv-codec-headers.git",
                  "tag": "n12.1.14.0",
                  "commit": "1889e62e2d35ff7aa9baca2bceb14f053785e6f1",
                  "x-checker-data": {
                    "type": "git",
                    "tag-pattern": "^n([\\d.]+)$"
                  }
                }
              ]
            },
            {
              "name": "ffmpeg",
              "config-opts": [
                "--enable-shared",
                "--disable-static",
                "--enable-gnutls",
                "--enable-pic",
                "--disable-doc",
                "--disable-programs",
                "--disable-encoders",
                "--disable-muxers",
                "--disable-devices",
                "--enable-vaapi",
                "--enable-cuvid",
                "--enable-libdav1d",
                "--enable-gpl"
              ],
              "cleanup": [
                "/lib/pkgconfig",
                "/share",
                "/include"
              ],
              "sources": [
                {
                  "type": "git",
                  "url": "https://github.com/FFmpeg/FFmpeg.git",
                  "tag": "n6.1.1",
                  "commit": "e38092ef9395d7049f871ef4d5411eb410e283e0",
                  "x-checker-data": {
                    "type": "git",
                    "tag-pattern": "^n([\\d.]+)$"
                  }
                }
              ]
            },
            "shared-modules/luajit/luajit.json",
            {
              "name": "libass",
              "config-opts": [
                "--enable-shared",
                "--disable-static"
              ],
              "cleanup": [
                "/lib/*.la",
                "/lib/pkgconfig",
                "/include"
              ],
              "sources": [
                {
                  "type": "git",
                  "url": "https://github.com/libass/libass.git",
                  "tag": "0.17.1",
                  "commit": "e8ad72accd3a84268275a9385beb701c9284e5b3",
                  "x-checker-data": {
                    "type": "git",
                    "tag-pattern": "^([\\d.]+)$"
                  }
                }
              ]
            },
            {
              "name": "uchardet",
              "buildsystem": "cmake-ninja",
              "config-opts": [
                "-DCMAKE_BUILD_TYPE=Release",
                "-DCMAKE_INSTALL_LIBDIR=lib",
                "-DBUILD_BINARY=OFF"
              ],
              "cleanup": [
                "/lib/*.a",
                "/lib/pkgconfig",
                "/share",
                "/include"
              ],
              "sources": [
                {
                  "type": "archive",
                  "url": "https://www.freedesktop.org/software/uchardet/releases/uchardet-0.0.8.tar.xz",
                  "sha256": "e97a60cfc00a1c147a674b097bb1422abd9fa78a2d9ce3f3fdcc2e78a34ac5f0",
                  "x-checker-data": {
                    "type": "html",
                    "url": "https://www.freedesktop.org/software/uchardet/releases/",
                    "version-pattern": "uchardet-(\\d+\\.\\d+\\.\\d+)\\.tar\\.xz",
                    "url-template": "https://www.freedesktop.org/software/uchardet/releases/uchardet-$version.tar.xz"
                  }
                }
              ]
            },
            {
              "name": "libplacebo",
              "buildsystem": "meson",
              "config-opts": [
                "-Dvulkan=enabled",
                "-Dshaderc=enabled"
              ],
              "cleanup": [
                "/include",
                "/lib/pkgconfig"
              ],
              "sources": [
                {
                  "type": "git",
                  "url": "https://code.videolan.org/videolan/libplacebo.git",
                  "tag": "v6.338.2",
                  "commit": "64c1954570f1cd57f8570a57e51fb0249b57bb90",
                  "x-checker-data": {
                    "type": "git",
                    "tag-pattern": "^v([\\d.]+)$"
                  }
                }
              ],
              "modules": [
                {
                  "name": "shaderc",
                  "buildsystem": "cmake-ninja",
                  "builddir": true,
                  "config-opts": [
                    "-DSHADERC_SKIP_COPYRIGHT_CHECK=ON",
                    "-DSHADERC_SKIP_EXAMPLES=ON",
                    "-DSHADERC_SKIP_TESTS=ON",
                    "-DSPIRV_SKIP_EXECUTABLES=ON",
                    "-DENABLE_GLSLANG_BINARIES=OFF",
                    "-DCMAKE_BUILD_TYPE=Release"
                  ],
                  "cleanup": [
                    "/bin",
                    "/include",
                    "/lib/*.a",
                    "/lib/cmake",
                    "/lib/pkgconfig"
                  ],
                  "sources": [
                    {
                      "type": "git",
                      "url": "https://github.com/google/shaderc.git",
                      "tag": "v2024.0",
                      "commit": "d792558a8902cb39b1c237243cc4edab226513a5",
                      "x-checker-data": {
                        "type": "git",
                        "tag-pattern": "^v([\\d.]+)$"
                      }
                    },
                    {
                      "type": "git",
                      "url": "https://github.com/KhronosGroup/SPIRV-Tools.git",
                      "tag": "v2024.1",
                      "commit": "04896c462d9f3f504c99a4698605b6524af813c1",
                      "dest": "third_party/spirv-tools",
                      "x-checker-data": {
                        "type": "git",
                        "tag-pattern": "^v([\\d.]+)$"
                      }
                    },
                    {
                      "type": "git",
                      "url": "https://github.com/KhronosGroup/SPIRV-Headers.git",
                      "tag": "sdk-1.3.250.1",
                      "commit": "268a061764ee69f09a477a695bf6a11ffe311b8d",
                      "dest": "third_party/spirv-headers"
                    },
                    {
                      "type": "git",
                      "url": "https://github.com/KhronosGroup/glslang.git",
                      "tag": "14.1.0",
                      "commit": "ee2f5d09eaf8f4e8d0d598bd2172fce290d4ca60",
                      "dest": "third_party/glslang",
                      "x-checker-data": {
                        "type": "git",
                        "tag-pattern": "^([\\d.]+)$"
                      }
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
